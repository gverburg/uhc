-- $Id: Ruler.ag 231 2005-06-07 14:39:41Z atze $

-------------------------------------------------------------------------
-- Optimisation
-------------------------------------------------------------------------

-------------------------------------------------------------------------
-- Part III: Elimination of assignments to wildcard
-------------------------------------------------------------------------

-------------------------------------------------------------------------
-- Replica
-------------------------------------------------------------------------

ATTR AllARule AllExpr [ | | replEw: SELF ]
ATTR AGARuleItf [ | | replEw: ARule ]
ATTR AEqns AEqn [ | | replEwEqns USE {++} {[]}: {[AEqn]} ]

SEM AEqn
  | Eqn             lhs     .   replEwEqns  =   case @dest.replEw of
                                                  AEqnDest_One ANm_Wild -> []
                                                  _                     -> [@replEw]
  | * - Eqn         lhs     .   replEwEqns  =   [@replEw]

SEM ARule
  | Rule            lhs     .   replEw      =   ARule_Rule @ndNmL @rlNm @info @eqns.replEwEqns


